{"id":"fB8K","dependencies":[{"name":"D:\\testhub\\node_modules\\@giphy\\js-fetch-api\\dist\\request.js.map","includedInParent":true,"mtime":499162500000},{"name":"D:\\testhub\\node_modules\\@giphy\\js-fetch-api\\src\\request.ts","includedInParent":true,"mtime":499162500000},{"name":"D:\\testhub\\package.json","includedInParent":true,"mtime":1633782651602},{"name":"D:\\testhub\\node_modules\\@giphy\\js-fetch-api\\package.json","includedInParent":true,"mtime":1633781127523},{"name":"./constants","loc":{"line":43,"column":26},"parent":"D:\\testhub\\node_modules\\@giphy\\js-fetch-api\\dist\\request.js","resolved":"D:\\testhub\\node_modules\\@giphy\\js-fetch-api\\dist\\constants.js"},{"name":"./fetch-error","loc":{"line":44,"column":44},"parent":"D:\\testhub\\node_modules\\@giphy\\js-fetch-api\\dist\\request.js","resolved":"D:\\testhub\\node_modules\\@giphy\\js-fetch-api\\dist\\fetch-error.js"}],"generated":{"js":"\"use strict\";var e=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(s,o){function a(e){try{i(n.next(e))}catch(t){o(t)}}function u(e){try{i(n.throw(e))}catch(t){o(t)}}function i(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,u)}i((n=n.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var r,n,s,o,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},\"function\"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(r=1,n&&(s=2&o[0]?n.return:o[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(s=(s=a.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){a.label=o[1];break}if(6===o[0]&&a.label<s[1]){a.label=s[1],s=o;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(o);break}s[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(u){o=[6,u],n=0}finally{r=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.DEFAULT_ERROR=exports.ERROR_PREFIX=void 0;var n=require(\"./constants\"),s=r(require(\"./fetch-error\"));exports.ERROR_PREFIX=\"@giphy/js-fetch-api: \",exports.DEFAULT_ERROR=\"Error fetching\";var o=function(e){return e},a={},u=6e4,i=6e3,c=function(){var e=Date.now();Object.keys(a).forEach(function(t){var r=a[t].isError?i:u;e-a[t].ts>=r&&delete a[t]})};function l(r,u,i){var l=this;if(void 0===u&&(u=o),void 0===i&&(i=!1),c(),!a[r]||i){a[r]={request:e(l,void 0,void 0,function(){var e,o,i,c,l,f;return t(this,function(t){switch(t.label){case 0:return t.trys.push([0,9,,10]),[4,fetch(\"\"+n.serverUrl+r,{method:\"get\"})];case 1:return(o=t.sent()).ok?[4,o.json()]:[3,3];case 2:if(c=t.sent(),null===(f=c.meta)||void 0===f?void 0:f.response_id)return[2,u(c)];throw{message:\"synthetic response\"};case 3:i=exports.DEFAULT_ERROR,t.label=4;case 4:return t.trys.push([4,6,,7]),[4,o.json()];case 5:return(c=t.sent()).message&&(i=c.message),[3,7];case 6:return t.sent(),[3,7];case 7:a[r]&&(a[r].isError=!0),e=new s.default(\"\"+exports.ERROR_PREFIX+i,o.status,o.statusText),t.label=8;case 8:return[3,10];case 9:return l=t.sent(),e=new s.default(l.message),a[r]&&(a[r].isError=!0),[3,10];case 10:throw e}})}),ts:Date.now()}}return a[r].request}exports.default=l;"},"sourceMaps":{"js":{"mappings":[{"source":"../src/request.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":1601}},{"source":"../src/request.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":1605}},{"source":"../src/request.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":1607}},{"source":"../src/request.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":1615}},{"source":"../src/request.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":1630}},{"source":"../src/request.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":1632}},{"source":"../src/request.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":1634}},{"source":"../src/request.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":1642}},{"source":"../src/request.ts","name":null,"original":{"line":5,"column":13},"generated":{"line":1,"column":1660}},{"source":"../src/request.ts","name":null,"original":{"line":5,"column":13},"generated":{"line":1,"column":1668}},{"source":"../src/request.ts","name":null,"original":{"line":5,"column":28},"generated":{"line":1,"column":1681}},{"source":"../src/request.ts","name":null,"original":{"line":6,"column":13},"generated":{"line":1,"column":1705}},{"source":"../src/request.ts","name":null,"original":{"line":6,"column":13},"generated":{"line":1,"column":1713}},{"source":"../src/request.ts","name":null,"original":{"line":6,"column":29},"generated":{"line":1,"column":1727}},{"source":"../src/request.ts","name":null,"original":{"line":8,"column":0},"generated":{"line":1,"column":1744}},{"source":"../src/request.ts","name":null,"original":{"line":8,"column":6},"generated":{"line":1,"column":1748}},{"source":"../src/request.ts","name":null,"original":{"line":8,"column":17},"generated":{"line":1,"column":1750}},{"source":"../src/request.ts","name":null,"original":{"line":8,"column":18},"generated":{"line":1,"column":1759}},{"source":"../src/request.ts","name":null,"original":{"line":8,"column":29},"generated":{"line":1,"column":1762}},{"source":"../src/request.ts","name":null,"original":{"line":8,"column":29},"generated":{"line":1,"column":1769}},{"source":"../src/request.ts","name":null,"original":{"line":9,"column":6},"generated":{"line":1,"column":1772}},{"source":"../src/request.ts","name":null,"original":{"line":15,"column":4},"generated":{"line":1,"column":1774}},{"source":"../src/request.ts","name":null,"original":{"line":17,"column":6},"generated":{"line":1,"column":1777}},{"source":"../src/request.ts","name":null,"original":{"line":17,"column":16},"generated":{"line":1,"column":1779}},{"source":"../src/request.ts","name":null,"original":{"line":18,"column":6},"generated":{"line":1,"column":1783}},{"source":"../src/request.ts","name":null,"original":{"line":18,"column":21},"generated":{"line":1,"column":1785}},{"source":"../src/request.ts","name":null,"original":{"line":20,"column":6},"generated":{"line":1,"column":1789}},{"source":"../src/request.ts","name":null,"original":{"line":20,"column":19},"generated":{"line":1,"column":1791}},{"source":"../src/request.ts","name":null,"original":{"line":21,"column":4},"generated":{"line":1,"column":1802}},{"source":"../src/request.ts","name":null,"original":{"line":21,"column":10},"generated":{"line":1,"column":1806}},{"source":"../src/request.ts","name":null,"original":{"line":21,"column":16},"generated":{"line":1,"column":1808}},{"source":"../src/request.ts","name":null,"original":{"line":21,"column":21},"generated":{"line":1,"column":1813}},{"source":"../src/request.ts","name":null,"original":{"line":22,"column":4},"generated":{"line":1,"column":1819}},{"source":"../src/request.ts","name":null,"original":{"line":22,"column":11},"generated":{"line":1,"column":1826}},{"source":"../src/request.ts","name":null,"original":{"line":22,"column":16},"generated":{"line":1,"column":1831}},{"source":"../src/request.ts","name":null,"original":{"line":22,"column":28},"generated":{"line":1,"column":1834}},{"source":"../src/request.ts","name":null,"original":{"line":22,"column":36},"generated":{"line":1,"column":1842}},{"source":"../src/request.ts","name":null,"original":{"line":22,"column":37},"generated":{"line":1,"column":1851}},{"source":"../src/request.ts","name":null,"original":{"line":23,"column":8},"generated":{"line":1,"column":1854}},{"source":"../src/request.ts","name":null,"original":{"line":23,"column":14},"generated":{"line":1,"column":1858}},{"source":"../src/request.ts","name":null,"original":{"line":23,"column":20},"generated":{"line":1,"column":1860}},{"source":"../src/request.ts","name":null,"original":{"line":23,"column":31},"generated":{"line":1,"column":1862}},{"source":"../src/request.ts","name":null,"original":{"line":23,"column":36},"generated":{"line":1,"column":1865}},{"source":"../src/request.ts","name":null,"original":{"line":23,"column":46},"generated":{"line":1,"column":1873}},{"source":"../src/request.ts","name":null,"original":{"line":23,"column":61},"generated":{"line":1,"column":1875}},{"source":"../src/request.ts","name":null,"original":{"line":24,"column":12},"generated":{"line":1,"column":1877}},{"source":"../src/request.ts","name":null,"original":{"line":24,"column":18},"generated":{"line":1,"column":1879}},{"source":"../src/request.ts","name":null,"original":{"line":24,"column":29},"generated":{"line":1,"column":1881}},{"source":"../src/request.ts","name":null,"original":{"line":24,"column":34},"generated":{"line":1,"column":1884}},{"source":"../src/request.ts","name":null,"original":{"line":24,"column":40},"generated":{"line":1,"column":1888}},{"source":"../src/request.ts","name":null,"original":{"line":25,"column":19},"generated":{"line":1,"column":1898}},{"source":"../src/request.ts","name":null,"original":{"line":25,"column":30},"generated":{"line":1,"column":1900}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":0},"generated":{"line":1,"column":1906}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":9},"generated":{"line":1,"column":1915}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":17},"generated":{"line":1,"column":1917}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":30},"generated":{"line":1,"column":1919}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":70},"generated":{"line":1,"column":1921}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":0},"generated":{"line":1,"column":1924}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":0},"generated":{"line":1,"column":1928}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":0},"generated":{"line":1,"column":1930}},{"source":"../src/request.ts","name":null,"original":{"line":32,"column":4},"generated":{"line":1,"column":1935}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":30},"generated":{"line":1,"column":1943}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":30},"generated":{"line":1,"column":1947}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":30},"generated":{"line":1,"column":1951}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":30},"generated":{"line":1,"column":1953}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":70},"generated":{"line":1,"column":1961}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":70},"generated":{"line":1,"column":1965}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":70},"generated":{"line":1,"column":1969}},{"source":"../src/request.ts","name":null,"original":{"line":30,"column":70},"generated":{"line":1,"column":1972}},{"source":"../src/request.ts","name":null,"original":{"line":31,"column":4},"generated":{"line":1,"column":1975}},{"source":"../src/request.ts","name":null,"original":{"line":32,"column":9},"generated":{"line":1,"column":1980}},{"source":"../src/request.ts","name":null,"original":{"line":32,"column":20},"generated":{"line":1,"column":1982}},{"source":"../src/request.ts","name":null,"original":{"line":32,"column":28},"generated":{"line":1,"column":1986}},{"source":"../src/request.ts","name":null,"original":{"line":32,"column":37},"generated":{"line":1,"column":1988}},{"source":"../src/request.ts","name":null,"original":{"line":75,"column":8},"generated":{"line":1,"column":1989}},{"source":"../src/request.ts","name":null,"original":{"line":75,"column":19},"generated":{"line":1,"column":1991}},{"source":"../src/request.ts","name":null,"original":{"line":75,"column":26},"generated":{"line":1,"column":1994}},{"source":"../src/request.ts","name":null,"original":{"line":75,"column":28},"generated":{"line":1,"column":1995}},{"source":"../src/request.ts","name":null,"original":{"line":33,"column":28},"generated":{"line":1,"column":2003}},{"source":"../src/request.ts","name":null,"original":{"line":33,"column":28},"generated":{"line":1,"column":2005}},{"source":"../src/request.ts","name":null,"original":{"line":33,"column":28},"generated":{"line":1,"column":2012}},{"source":"../src/request.ts","name":null,"original":{"line":33,"column":28},"generated":{"line":1,"column":2019}},{"source":"../src/request.ts","name":null,"original":{"line":33,"column":28},"generated":{"line":1,"column":2021}},{"source":"../src/request.ts","name":null,"original":{"line":36,"column":33},"generated":{"line":1,"column":2097}},{"source":"../src/request.ts","name":null,"original":{"line":36,"column":33},"generated":{"line":1,"column":2127}},{"source":"../src/request.ts","name":null,"original":{"line":36,"column":33},"generated":{"line":1,"column":2128}},{"source":"../src/request.ts","name":null,"original":{"line":36,"column":39},"generated":{"line":1,"column":2130}},{"source":"../src/request.ts","name":null,"original":{"line":36,"column":45},"generated":{"line":1,"column":2136}},{"source":"../src/request.ts","name":null,"original":{"line":36,"column":48},"generated":{"line":1,"column":2139}},{"source":"../src/request.ts","name":null,"original":{"line":36,"column":48},"generated":{"line":1,"column":2141}},{"source":"../src/request.ts","name":null,"original":{"line":36,"column":60},"generated":{"line":1,"column":2151}},{"source":"../src/request.ts","name":null,"original":{"line":36,"column":67},"generated":{"line":1,"column":2153}},{"source":"../src/request.ts","name":null,"original":{"line":37,"column":20},"generated":{"line":1,"column":2154}},{"source":"../src/request.ts","name":null,"original":{"line":37,"column":28},"generated":{"line":1,"column":2161}},{"source":"../src/request.ts","name":null,"original":{"line":36,"column":22},"generated":{"line":1,"column":2184}},{"source":"../src/request.ts","name":null,"original":{"line":36,"column":33},"generated":{"line":1,"column":2186}},{"source":"../src/request.ts","name":null,"original":{"line":36,"column":33},"generated":{"line":1,"column":2188}},{"source":"../src/request.ts","name":null,"original":{"line":39,"column":29},"generated":{"line":1,"column":2196}},{"source":"../src/request.ts","name":null,"original":{"line":40,"column":36},"generated":{"line":1,"column":2199}},{"source":"../src/request.ts","name":null,"original":{"line":40,"column":36},"generated":{"line":1,"column":2200}},{"source":"../src/request.ts","name":null,"original":{"line":40,"column":42},"generated":{"line":1,"column":2202}},{"source":"../src/request.ts","name":null,"original":{"line":40,"column":51},"generated":{"line":1,"column":2204}},{"source":"../src/request.ts","name":null,"original":{"line":39,"column":20},"generated":{"line":1,"column":2212}},{"source":"../src/request.ts","name":null,"original":{"line":39,"column":20},"generated":{"line":1,"column":2213}},{"source":"../src/request.ts","name":null,"original":{"line":39,"column":20},"generated":{"line":1,"column":2215}},{"source":"../src/request.ts","name":null,"original":{"line":42,"column":20},"generated":{"line":1,"column":2225}},{"source":"../src/request.ts","name":null,"original":{"line":40,"column":26},"generated":{"line":1,"column":2228}},{"source":"../src/request.ts","name":null,"original":{"line":40,"column":36},"generated":{"line":1,"column":2230}},{"source":"../src/request.ts","name":null,"original":{"line":40,"column":36},"generated":{"line":1,"column":2232}},{"source":"../src/request.ts","name":null,"original":{"line":42,"column":36},"generated":{"line":1,"column":2239}},{"source":"../src/request.ts","name":null,"original":{"line":42,"column":25},"generated":{"line":1,"column":2247}},{"source":"../src/request.ts","name":null,"original":{"line":42,"column":25},"generated":{"line":1,"column":2249}},{"source":"../src/request.ts","name":null,"original":{"line":42,"column":32},"generated":{"line":1,"column":2251}},{"source":"../src/request.ts","name":null,"original":{"line":42,"column":36},"generated":{"line":1,"column":2263}},{"source":"../src/request.ts","name":null,"original":{"line":42,"column":36},"generated":{"line":1,"column":2267}},{"source":"../src/request.ts","name":null,"original":{"line":42,"column":36},"generated":{"line":1,"column":2274}},{"source":"../src/request.ts","name":null,"original":{"line":42,"column":36},"generated":{"line":1,"column":2276}},{"source":"../src/request.ts","name":null,"original":{"line":42,"column":38},"generated":{"line":1,"column":2278}},{"source":"../src/request.ts","name":null,"original":{"line":46,"column":24},"generated":{"line":1,"column":2290}},{"source":"../src/request.ts","name":null,"original":{"line":46,"column":24},"generated":{"line":1,"column":2296}},{"source":"../src/request.ts","name":null,"original":{"line":46,"column":24},"generated":{"line":1,"column":2297}},{"source":"../src/request.ts","name":null,"original":{"line":46,"column":31},"generated":{"line":1,"column":2299}},{"source":"../src/request.ts","name":null,"original":{"line":46,"column":42},"generated":{"line":1,"column":2301}},{"source":"../src/request.ts","name":null,"original":{"line":43,"column":24},"generated":{"line":1,"column":2305}},{"source":"../src/request.ts","name":null,"original":{"line":43,"column":30},"generated":{"line":1,"column":2310}},{"source":"../src/request.ts","name":null,"original":{"line":43,"column":32},"generated":{"line":1,"column":2311}},{"source":"../src/request.ts","name":null,"original":{"line":43,"column":41},"generated":{"line":1,"column":2319}},{"source":"../src/request.ts","name":null,"original":{"line":49,"column":24},"generated":{"line":1,"column":2348}},{"source":"../src/request.ts","name":null,"original":{"line":49,"column":34},"generated":{"line":1,"column":2350}},{"source":"../src/request.ts","name":null,"original":{"line":49,"column":34},"generated":{"line":1,"column":2358}},{"source":"../src/request.ts","name":null,"original":{"line":52,"column":40},"generated":{"line":1,"column":2389}},{"source":"../src/request.ts","name":null,"original":{"line":52,"column":40},"generated":{"line":1,"column":2418}},{"source":"../src/request.ts","name":null,"original":{"line":52,"column":40},"generated":{"line":1,"column":2419}},{"source":"../src/request.ts","name":null,"original":{"line":52,"column":46},"generated":{"line":1,"column":2421}},{"source":"../src/request.ts","name":null,"original":{"line":52,"column":55},"generated":{"line":1,"column":2423}},{"source":"../src/request.ts","name":null,"original":{"line":52,"column":30},"generated":{"line":1,"column":2445}},{"source":"../src/request.ts","name":null,"original":{"line":52,"column":40},"generated":{"line":1,"column":2447}},{"source":"../src/request.ts","name":null,"original":{"line":52,"column":40},"generated":{"line":1,"column":2449}},{"source":"../src/request.ts","name":null,"original":{"line":53,"column":35},"generated":{"line":1,"column":2457}},{"source":"../src/request.ts","name":null,"original":{"line":53,"column":44},"generated":{"line":1,"column":2467}},{"source":"../src/request.ts","name":null,"original":{"line":53,"column":54},"generated":{"line":1,"column":2469}},{"source":"../src/request.ts","name":null,"original":{"line":53,"column":61},"generated":{"line":1,"column":2471}},{"source":"../src/request.ts","name":null,"original":{"line":55,"column":24},"generated":{"line":1,"column":2522}},{"source":"../src/request.ts","name":null,"original":{"line":55,"column":35},"generated":{"line":1,"column":2524}},{"source":"../src/request.ts","name":null,"original":{"line":59,"column":24},"generated":{"line":1,"column":2529}},{"source":"../src/request.ts","name":null,"original":{"line":59,"column":35},"generated":{"line":1,"column":2531}},{"source":"../src/request.ts","name":null,"original":{"line":59,"column":40},"generated":{"line":1,"column":2534}},{"source":"../src/request.ts","name":null,"original":{"line":59,"column":50},"generated":{"line":1,"column":2543}},{"source":"../src/request.ts","name":null,"original":{"line":63,"column":20},"generated":{"line":1,"column":2546}},{"source":"../src/request.ts","name":null,"original":{"line":63,"column":33},"generated":{"line":1,"column":2548}},{"source":"../src/request.ts","name":null,"original":{"line":63,"column":37},"generated":{"line":1,"column":2552}},{"source":"../src/request.ts","name":null,"original":{"line":63,"column":37},"generated":{"line":1,"column":2554}},{"source":"../src/request.ts","name":null,"original":{"line":63,"column":48},"generated":{"line":1,"column":2562}},{"source":"../src/request.ts","name":null,"original":{"line":63,"column":51},"generated":{"line":1,"column":2565}},{"source":"../src/request.ts","name":null,"original":{"line":63,"column":51},"generated":{"line":1,"column":2573}},{"source":"../src/request.ts","name":null,"original":{"line":63,"column":66},"generated":{"line":1,"column":2586}},{"source":"../src/request.ts","name":null,"original":{"line":63,"column":77},"generated":{"line":1,"column":2588}},{"source":"../src/request.ts","name":null,"original":{"line":63,"column":86},"generated":{"line":1,"column":2590}},{"source":"../src/request.ts","name":null,"original":{"line":63,"column":94},"generated":{"line":1,"column":2597}},{"source":"../src/request.ts","name":null,"original":{"line":63,"column":103},"generated":{"line":1,"column":2599}},{"source":"../src/request.ts","name":null,"original":{"line":66,"column":16},"generated":{"line":1,"column":2666}},{"source":"../src/request.ts","name":null,"original":{"line":66,"column":29},"generated":{"line":1,"column":2668}},{"source":"../src/request.ts","name":null,"original":{"line":66,"column":33},"generated":{"line":1,"column":2672}},{"source":"../src/request.ts","name":null,"original":{"line":66,"column":33},"generated":{"line":1,"column":2674}},{"source":"../src/request.ts","name":null,"original":{"line":66,"column":44},"generated":{"line":1,"column":2682}},{"source":"../src/request.ts","name":null,"original":{"line":66,"column":60},"generated":{"line":1,"column":2684}},{"source":"../src/request.ts","name":null,"original":{"line":69,"column":20},"generated":{"line":1,"column":2693}},{"source":"../src/request.ts","name":null,"original":{"line":69,"column":31},"generated":{"line":1,"column":2695}},{"source":"../src/request.ts","name":null,"original":{"line":70,"column":20},"generated":{"line":1,"column":2700}},{"source":"../src/request.ts","name":null,"original":{"line":70,"column":31},"generated":{"line":1,"column":2702}},{"source":"../src/request.ts","name":null,"original":{"line":70,"column":36},"generated":{"line":1,"column":2705}},{"source":"../src/request.ts","name":null,"original":{"line":70,"column":46},"generated":{"line":1,"column":2714}},{"source":"../src/request.ts","name":null,"original":{"line":73,"column":12},"generated":{"line":1,"column":2732}},{"source":"../src/request.ts","name":null,"original":{"line":73,"column":18},"generated":{"line":1,"column":2738}},{"source":"../src/request.ts","name":null,"original":{"line":75,"column":52},"generated":{"line":1,"column":2745}},{"source":"../src/request.ts","name":null,"original":{"line":75,"column":56},"generated":{"line":1,"column":2748}},{"source":"../src/request.ts","name":null,"original":{"line":75,"column":61},"generated":{"line":1,"column":2753}},{"source":"../src/request.ts","name":null,"original":{"line":77,"column":4},"generated":{"line":1,"column":2760}},{"source":"../src/request.ts","name":null,"original":{"line":77,"column":11},"generated":{"line":1,"column":2767}},{"source":"../src/request.ts","name":null,"original":{"line":77,"column":22},"generated":{"line":1,"column":2769}},{"source":"../src/request.ts","name":null,"original":{"line":77,"column":27},"generated":{"line":1,"column":2772}},{"source":"../src/request.ts","name":null,"original":{"line":80,"column":0},"generated":{"line":1,"column":2780}},{"source":"../src/request.ts","name":null,"original":{"line":80,"column":0},"generated":{"line":1,"column":2788}},{"source":"../src/request.ts","name":null,"original":{"line":80,"column":15},"generated":{"line":1,"column":2796}}],"sources":{"../src/request.ts":"import { serverUrl } from './constants'\nimport FetchError from './fetch-error'\nimport { ErrorResult, Result } from './result-types'\n\nexport const ERROR_PREFIX = `@giphy/js-fetch-api: `\nexport const DEFAULT_ERROR = 'Error fetching'\n\nconst identity = (i: any) => i\nconst requestMap: {\n    [key: string]: {\n        request: Promise<Result>\n        ts: number // timestamp\n        isError?: boolean\n    }\n} = {}\n\nconst maxLife = 60000 // clear memory cache every minute\nconst errorMaxLife = 6000 // clear error memory cache after a second\n\nconst purgeCache = () => {\n    const now = Date.now()\n    Object.keys(requestMap).forEach((key: string) => {\n        const ttl = requestMap[key].isError ? errorMaxLife : maxLife\n        if (now - requestMap[key].ts >= ttl) {\n            delete requestMap[key]\n        }\n    })\n}\n\nfunction request(url: string, normalizer: (a: any) => any = identity, noCache: boolean = false) {\n    purgeCache()\n    if (!requestMap[url] || noCache) {\n        const makeRequest = async (): Promise<Result> => {\n            let fetchError: FetchError\n            try {\n                const response = await fetch(`${serverUrl}${url}`, {\n                    method: 'get',\n                })\n                if (response.ok) {\n                    const result = (await response.json()) as Result\n                    // no response id is an indiication of a synthetic response\n                    if (!result.meta?.response_id) {\n                        throw { message: `synthetic response` } as ErrorResult\n                    } else {\n                        // if everything is successful, we return here, otherwise an error will be thrown\n                        return normalizer(result)\n                    }\n                } else {\n                    let message = DEFAULT_ERROR\n                    try {\n                        // error results have a different format than regular results\n                        const result = (await response.json()) as ErrorResult\n                        if (result.message) message = result.message\n                    } catch (_) {}\n                    if (requestMap[url]) {\n                        // we got a specific error,\n                        // normally, you'd want to not fetch this again,\n                        // but the api goes down and sends 400s, so allow a refetch after errorMaxLife\n                        requestMap[url].isError = true\n                    }\n\n                    // we got an error response, throw with the message in the response body json\n                    fetchError = new FetchError(`${ERROR_PREFIX}${message}`, response.status, response.statusText)\n                }\n            } catch (unexpectedError) {\n                fetchError = new FetchError(unexpectedError.message)\n                // if the request fails with an unspecfied error,\n                // the user can request again after the error timeout\n                if (requestMap[url]) {\n                    requestMap[url].isError = true\n                }\n            }\n            throw fetchError\n        }\n        requestMap[url] = { request: makeRequest(), ts: Date.now() }\n    }\n    return requestMap[url].request\n}\n\nexport default request\n"},"lineCount":null}},"error":null,"hash":"8f79aab86ff6866597ec9260b54645cc","cacheData":{"env":{}}}